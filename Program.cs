using System;
using System.Linq; // –ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –º–µ—Ç–æ–¥—É OrderByDescending (LINQ)

namespace LabWork
{
    // –î–∞–Ω–∏–π –ø—Ä–æ–µ–∫—Ç —î —à–∞–±–ª–æ–Ω–æ–º –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∏—Ö —Ä–æ–±—ñ—Ç
    // –∑ –∫—É—Ä—Å—É "–û–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è —Ç–∞ –ø–∞—Ç–µ—Ä–Ω–∏ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è"

    /// <summary>
    /// –ö–ª–∞—Å, —â–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω—É –ü—Ä–æ–≥—Ä–µ—Å—ñ—é.
    /// –•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—î—Ç—å—Å—è –ø–µ—Ä—à–∏–º —á–ª–µ–Ω–æ–º (a0), —Ä—ñ–∑–Ω–∏—Ü–µ—é (d) —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —á–ª–µ–Ω—ñ–≤ (n).
    /// </summary>
    public class ArithmeticProgression
    {
        // –ü—Ä–∏–≤–∞—Ç–Ω—ñ –ø–æ–ª—è (–∑ –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º _) –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö. –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —ñ–Ω–∫–∞–ø—Å—É–ª—è—Ü—ñ—ó.
        private readonly double _firstTerm;
        private readonly double _difference;
        private readonly int _termsCount;

        /// <summary>
        /// –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å: –ü–µ—Ä—à–∏–π —á–ª–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó (a0).
        /// </summary>
        public double FirstTerm => _firstTerm;

        /// <summary>
        /// –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å: –†—ñ–∑–Ω–∏—Ü—è –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó (d).
        /// </summary>
        public double Difference => _difference;

        /// <summary>
        /// –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å: –ö—ñ–ª—å–∫—ñ—Å—Ç—å —á–ª–µ–Ω—ñ–≤ –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó (n).
        /// </summary>
        public int TermsCount => _termsCount;

        /// <summary>
        /// –û–±—á–∏—Å–ª—é–≤–∞–Ω–∞ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å: –ü–æ–≤–µ—Ä—Ç–∞—î —Å—É–º—É –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó.
        /// –û–±—á–∏—Å–ª—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—ñ –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é S = n/2 * (2*a0 + (n-1)*d).
        /// </summary>
        public double Sum
        {
            get
            {
                // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –≤–∏–ø–∞–¥–æ–∫, —è–∫—â–æ TermsCount –±—É–ª–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–æ (—Ö–æ—á–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —ó—ó –≤–∂–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î)
                if (_termsCount <= 0)
                {
                    return 0;
                }
                
                // –§–æ—Ä–º—É–ª–∞ –¥–ª—è —Å—É–º–∏ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–æ—ó –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó: S = n/2 * (2*a0 + (n-1)*d)
                return (double)_termsCount / 2 * (2 * _firstTerm + (_termsCount - 1) * _difference);
            }
        }

        /// <summary>
        /// –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –¥–ª—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–æ—ó –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó.
        /// </summary>
        /// <param name="a0">–ü–µ—Ä—à–∏–π —á–ª–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó.</param>
        /// <param name="d">–†—ñ–∑–Ω–∏—Ü—è –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó.</param>
        /// <param name="n">–ö—ñ–ª—å–∫—ñ—Å—Ç—å —á–ª–µ–Ω—ñ–≤ –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó (–º–∞—î –±—É—Ç–∏ > 0).</param>
        public ArithmeticProgression(double a0, double d, int n)
        {
            if (n <= 0)
            {
                // –Ø—Å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É
                throw new ArgumentException("–ö—ñ–ª—å–∫—ñ—Å—Ç—å —á–ª–µ–Ω—ñ–≤ (n) –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –±—ñ–ª—å—à–æ—é –∑–∞ –Ω—É–ª—å.", nameof(n));
            }

            _firstTerm = a0;
            _difference = d;
            _termsCount = n;
        }

        /// <summary>
        /// –ü–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ –≤–∏–≤–µ–¥–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó.
        /// </summary>
        /// <returns>–†—è–¥–æ–∫ —ñ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó —Ç–∞ —ó—ó —Å—É–º–æ—é.</returns>
        public override string ToString()
        {
            return $"A.P.: a0={FirstTerm:F2}, d={Difference:F2}, n={TermsCount}, Sum={Sum:F2}";
        }
    }


    class Result
    {
        // TODO: do it ! (–õ–æ–≥—ñ–∫–∞ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –≤ Main, –∞–ª–µ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –¥–æ–ø–æ–º—ñ–∂–Ω—ñ –º–µ—Ç–æ–¥–∏ —Å—é–¥–∏)
    }

    class Program
    {
        /// <summary>
        /// –î–æ–ø–æ–º—ñ–∂–Ω–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –º–∞—Å–∏–≤—É –ø—Ä–æ–≥—Ä–µ—Å—ñ–π.
        /// </summary>
        /// <param name="count">–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—ñ–π.</param>
        /// <returns>–ú–∞—Å–∏–≤ –æ–±'—î–∫—Ç—ñ–≤ ArithmeticProgression.</returns>
        private static ArithmeticProgression[] CreateRandomProgressions(int count)
        {
            var progressions = new ArithmeticProgression[count];
            var random = new Random();

            for (int i = 0; i < count; i++)
            {
                // –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (a0, d - –¥—ñ–π—Å–Ω—ñ —á–∏—Å–ª–∞, n - —Ü—ñ–ª–µ > 0)
                double a0 = random.Next(-10, 11) + random.NextDouble();
                double d = random.Next(-5, 6) + random.NextDouble();
                int n = random.Next(3, 15); // –ö—ñ–ª—å–∫—ñ—Å—Ç—å —á–ª–µ–Ω—ñ–≤ –≤—ñ–¥ 3 –¥–æ 14

                progressions[i] = new ArithmeticProgression(a0, d, n);
            }

            // –î–æ–¥–∞–º–æ –æ–¥–Ω—É –ø—Ä–æ–≥—Ä–µ—Å—ñ—é –∑ –≤–µ–ª–∏–∫–æ—é —Å—É–º–æ—é –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è
            if (count > 0)
            {
                // a0=100, d=10, n=10. S_10 = 1450.00
                progressions[0] = new ArithmeticProgression(100.0, 10.0, 10);
            }

            return progressions;
        }


        static void Main(string[] args)
        {
            Console.OutputEncoding = System.Text.Encoding.UTF8;
            Console.WriteLine("--- üöÄ –û–±—á–∏—Å–ª–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—ñ–π —Ç–∞ –ø–æ—à—É–∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó —Å—É–º–∏ ---");
            
            // 1. –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ (–∞–±–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏) –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—ñ–π m
            const int m = 5;
            Console.WriteLine($"–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Å–∏–≤—É –∑ {m} –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–∏—Ö –ø—Ä–æ–≥—Ä–µ—Å—ñ–π (–≤–∏–ø–∞–¥–∫–æ–≤—ñ –¥–∞–Ω—ñ):");
            
            // 2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞—Å–∏–≤/—Å–ø–∏—Å–æ–∫ —Ä–æ–∑–º—ñ—Ä—É m —ñ –∑–∞–ø–æ–≤–Ω–∏—Ç–∏ –π–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏
            ArithmeticProgression[] progressions = CreateRandomProgressions(m);
            
            Console.WriteLine("\n–°—Ç–≤–æ—Ä–µ–Ω—ñ –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó:");
            int counter = 1;
            foreach (var p in progressions)
            {
                Console.WriteLine($"–ü—Ä–æ–≥—Ä–µ—Å—ñ—è #{counter++}: {p.ToString()}");
            }
            
            Console.WriteLine("\n----------------------------------------------");

            // 3. –ó–Ω–∞–π—Ç–∏ –µ–∫–∑–µ–º–ø–ª—è—Ä –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—é —Å—É–º–æ—é (–ø—Ä–æ–π—Ç–∏ –ø–æ –º–∞—Å–∏–≤—É, –æ–±—á–∏—Å–ª–∏—Ç–∏ Sum —ñ –∑–Ω–∞–π—Ç–∏ max)
            
            // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Linq –¥–ª—è –ª–∞–∫–æ–Ω—ñ—á–Ω–æ–≥–æ –ø–æ—à—É–∫—É –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó –∑ –Ω–∞–π–±—ñ–ª—å—à–æ—é Sum
            // –ü—Ä–∏–º—ñ—Ç–∫–∞: Linq –≤–∏–∫–ª–∏—á–µ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å Sum (—è–∫–∞ –æ–±—á–∏—Å–ª—é—î —Å—É–º—É) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞.
            ArithmeticProgression maxSumProgression = progressions
                .OrderByDescending(p => p.Sum) // –°–æ—Ä—Ç—É—î–º–æ –∑–∞ —Å–ø–∞–¥–∞–Ω–Ω—è–º —Å—É–º–∏
                .FirstOrDefault();             // –ë–µ—Ä–µ–º–æ –ø–µ—Ä—à–∏–π (–Ω–∞–π–±—ñ–ª—å—à–∏–π) –µ–ª–µ–º–µ–Ω—Ç
            
            if (maxSumProgression != null)
            {
                Console.WriteLine("üèÜ –ó–ù–ê–ô–î–ï–ù–û –ü–†–û–ì–†–ï–°–Ü–Æ –ó –ù–ê–ô–ë–Ü–õ–¨–®–û–Æ –°–£–ú–û–Æ:");
                Console.WriteLine(maxSumProgression.ToString());
            }
            else
            {
                Console.WriteLine("–ú–∞—Å–∏–≤ –ø—Ä–æ–≥—Ä–µ—Å—ñ–π –ø–æ—Ä–æ–∂–Ω—ñ–π –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É —Å—É–º—É.");
            }
            
            Console.WriteLine("\n--- –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏ ---");
        }
    }
}
